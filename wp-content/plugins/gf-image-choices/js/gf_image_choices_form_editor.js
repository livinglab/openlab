function imageChoices_getChoices(){var e=GetSelectedField(),i=jQuery("#field_"+e.id);i.find('[class*="-choice-row"]').each(function(i){var o=jQuery(this),s=o.data("index"),c=e.choices.length&&void 0!==e.choices[s].imageChoices_image?e.choices[s].imageChoices_image:"",t=e.choices.length&&void 0!==e.choices[s].imageChoices_imageID?e.choices[s].imageChoices_imageID:"";o.find(".image-choices-option-image").length||o.find(".field-choice-text").before(imageChoices_markup.choicesAdminRow(s,c,t));var a=o.find(".image-choices-option-image");""!==a.val()&&o.addClass("image-choices-has-image")}),imageChoices_updateFieldPreview(e)}function imageChoices_RemovePreview(e){if("undefined"!=typeof e){var i=jQuery(e).closest('[class*="-choice-row"]');i.find(".image-choices-option-image").val(""),i.find(".image-choices-option-image-id").val(""),i.find(".image-choices-option-preview").css("background-image",""),i.removeClass("image-choices-has-image"),imageChoices_UpdateFieldChoicesObject();var o=GetSelectedField();imageChoices_updateFieldPreview(o)}}function imageChoices_UpdateFieldChoicesObject(){var e=GetSelectedField(),i=imageChoices_getField(),o="quiz"===e.type?".gquiz-choice-row":'[class*="-choice-row"]';i.find(o).each(function(i){var o=jQuery(this),s=o.find(".image-choices-option-image").val(),c=o.find(".image-choices-option-image-id").val(),t=o.data("index");""!==s?(o.addClass("image-choices-has-image"),o.find(".gf-image-choices-option-preview").css("background-image","url("+s+")")):o.removeClass("image-choices-has-image"),e.choices[t].imageChoices_image=s,e.choices[t].imageChoices_imageID=c})}function imageChoices_updateFieldPreview(e){var i=jQuery("#field_"+e.id);e.imageChoices_enableImages&&void 0===e.imageChoices_showLabels&&imageChoices_toggleShowLabels(!0),i.find(".ginput_container .gfield_radio > li, .ginput_container .gfield_checkbox > li:not(.gchoice_select_all)").each(function(i){var o=jQuery(this);o.addClass("image-choices-choice");var s=o.find("label"),c=s.find(".image-choices-choice-text").length?s.find(".image-choices-choice-text").html():s.html();if(e.imageChoices_enableImages){if(e.choices.length>i){var t=void 0!==e.choices[i].imageChoices_image?e.choices[i].imageChoices_image:"";s.html(imageChoices_markup.choicesPreviewRow(i,c,t))}}else s.html(c)})}function imageChoices_getField(){var e=GetSelectedField(),i=jQuery("#field_"+e.id);return i}function imageChoices_removeAllChoices(e){var i=e.closest("#field_settings");i.find(".image-choices-option-image-remove").each(function(){jQuery(this).trigger("click")}),i.find(".gf_delete_field_choice").each(function(){jQuery(this).trigger("click")}),i.find('.field-choice-row input[type="text"], .gquiz-choice-row input[type="text"]').val("")}function imageChoices_isColorPickerPluginActive(){return window.hasOwnProperty("colorPickerFieldVars")&&"undefined"!=typeof window.colorPickerFieldVars}function imageChoices_toggleEnableImages(e){var i=imageChoices_getField(),o=i.find("input.field_choice_images_enabled");void 0===e&&(e=o.is(":checked")),e&&imageChoices_isColorPickerPluginActive()&&i.find("input.field_choice_colors_enabled").is(":checked")?window.confirm(imageChoicesFieldStrings.confirmImagesToggle)?(window.hasOwnProperty("colorPicker_toggleEnableColors")&&"function"==typeof window.colorPicker_toggleEnableColors&&window.colorPicker_toggleEnableColors(!1),imageChoices_onToggleEnableImages(e)):o.prop("checked",!1):imageChoices_onToggleEnableImages(e)}function imageChoices_onToggleEnableImages(e){var i=imageChoices_getField(),o=i.find("input.field_choice_images_enabled");void 0===e&&(e=o.is(":checked")),SetFieldProperty("imageChoices_enableImages",e),o.prop("checked",e);var s=jQuery('[id*="gfield_settings_choices_container"]');s.toggleClass("image-choices-enabled",e);var i=s.closest(".gfield");i.toggleClass("image-choices-use-images",e),i.toggleClass("image-choices-admin-field",e);var c=i.find("#gfield_settings_choices_container + input"),t=i.find("#gquiz_gfield_settings_choices_container + input"),a=i.find(".image-choices-remove-choices-btn");e&&!a.length&&(t.length&&t.after(imageChoices_markup.removeChoicesButton()),c.length&&c.after(imageChoices_markup.removeChoicesButton())),e||(i.removeClass("image-choices-layout-horizontal image-choices-layout-vertical"),a.length&&a.remove());var g=GetSelectedField(),l=jQuery(".field_setting.other_choice_setting"),n="radio"===g.type||"poll"===g.type&&"radio"===g.inputType;n&&l.show(),imageChoices_updateFieldPreview(g)}function imageChoices_toggleShowLabels(e){var i=imageChoices_getField(),o=i.find("input.image_choices_show_labels");void 0===e&&(e=o.is(":checked")),SetFieldProperty("imageChoices_showLabels",e),o.prop("checked",e),i.toggleClass("image-choices-show-labels",e)}function imageChoices_toggleShowPrices(e){var i=imageChoices_getField(),o=i.find("input.image_choices_show_prices");void 0===e&&(e=o.is(":checked")),SetFieldProperty("imageChoices_showPrices",e),o.prop("checked",e),i.toggleClass("image-choices-show-prices",e)}function imageChoices_toggleUseLightbox(e){var i=imageChoices_getField(),o=i.find("input.image_choices_use_lightbox");if(void 0===e&&(e=o.is(":checked")),SetFieldProperty("imageChoices_useLightbox",e),o.prop("checked",e),i.toggleClass("image-choices-use-lightbox",e),e){var s=GetSelectedField();jQuery.each(s.choices,function(e,i){if(!i.hasOwnProperty("imageChoices_imageID")||""===i.imageChoices_imageID)return window.alert(imageChoicesFieldStrings.useLightboxWarning),!1})}}function imageChoices_updateEntrySetting(e){SetFieldProperty("imageChoices_entrySetting",e)}function imageChoices_updateLayoutSetting(e){SetFieldProperty("imageChoices_choicesLayout",e);var i=GetSelectedField(),o=jQuery("#field_"+i.id);o.removeClass("image-choices-layout-horizontal image-choices-layout-vertical"),o.addClass("image-choices-layout-"+e)}function imageChoices_OpenMediaLibrary(e){if("undefined"!=typeof e){var i=jQuery(e).closest('[class*="-choice-row"]'),o=i.data("file-frame");if(o)return void o.open();o=wp.media({title:"Select an image to upload",button:{text:"Use this image"},frame:"post",state:"insert",multiple:!1}),setTimeout(function(){jQuery('input[value="Insert into Post"]').val("Use this Image"),jQuery("button.media-button-insert").text("Use this Image")},100),jQuery("body").on("click","li.attachment",function(){jQuery('input[value="Insert into Post"]').val("Use this Image"),jQuery("button.media-button-insert").text("Use this Image")}),o.on("insert",function(e){var s=o.state();if(e=e||s.get("selection")){var c=e.first(),t=s.display(c).toJSON();c=c.toJSON();var a=c.sizes[t.size].url;i.find(".image-choices-option-image").val(a),i.find(".image-choices-option-image-id").val(c.id),i.find(".image-choices-option-preview").css("background-image","url("+a+")"),i.addClass("image-choices-has-image"),imageChoices_UpdateFieldChoicesObject();var g=GetSelectedField();imageChoices_updateFieldPreview(g)}}),o.open(),i.data("file-frame",o)}}var imageChoices_markup=function(){return{removeChoicesButton:function(){return'<button class="button image-choices-remove-choices-btn" type="button" onclick="imageChoices_removeAllChoices(jQuery(this));">'+imageChoicesFieldStrings.removeAllChoices+"</button>"},enableImagesToggle:function(e,i){var o=e===!0?' checked="checked"':"";return['<div class="image-choices-toggle-wrap">','<label><input type="checkbox" '+o+' id="field_'+i+'_choice_images_enabled" class="field_choice_images_enabled" onclick="imageChoices_toggleEnableImages(this.checked);" onkeypress="imageChoices_toggleEnableImages(this.checked);"> '+imageChoicesFieldStrings.useImages+"</label>","</div>"].join("")},choicesAdminRow:function(e,i,o){var s=void 0!==e?e:0,c=void 0!==i?i:"",o=void 0!==o?o:"";return['<input type="button" id="image-choices-option-upload-button-'+s+'" class="button image-choices-option-upload-button" value="'+imageChoicesFieldStrings.uploadImage+'" onclick="imageChoices_OpenMediaLibrary(this);" />','<span id="image-choices-option-preview-'+s+'" class="image-choices-option-preview-wrap">','<span class="image-choices-option-preview" style="background-image:url('+c+');"></span>','<a href="javascript:void(0);" class="image-choices-option-image-remove" onclick="imageChoices_RemovePreview(this);" title="'+imageChoicesFieldStrings.removeImage+'"><i class="dashicons dashicons-no"></i></a>',"</span>",'<input type="hidden" id="image-choices-option-image-'+s+'" class="image-choices-option-image" value="'+c+'" />','<input type="hidden" id="image-choices-option-image-id-'+s+'" class="image-choices-option-image-id" value="'+o+'" />'].join("")},entryValueSelect:function(e,i){var o=void 0!==e?e:"form_setting",s="";form.hasOwnProperty("gf-image-choices")&&form["gf-image-choices"].hasOwnProperty("gf_image_choices_entry_value")&&(s=form["gf-image-choices"].gf_image_choices_entry_value);var c="";"value"==s?c=" ("+imageChoicesFieldStrings.entrySettingValue+")":"image"==s?c=" ("+imageChoicesFieldStrings.entrySettingImage+")":"text"==s?c=" ("+imageChoicesFieldStrings.entrySettingText+")":"image_text"==s?c=" ("+imageChoicesFieldStrings.entrySettingImageText+")":"image_value"==s&&(c=" ("+imageChoicesFieldStrings.entrySettingImageValue+")");var t="form_setting"===o?' selected="selected"':"",a="value"===o?' selected="selected"':"",g="image"===o?' selected="selected"':"",l="text"===o?' selected="selected"':"",n="image_text"===o?' selected="selected"':"",h="image_value"===o?' selected="selected"':"";return['<li class="image-choices-setting-entry-value field_setting">','<label class="section_label">'+imageChoicesFieldStrings.entrySettingTitle+"</label>",'<select id="image-choices-entry-value-'+i+'" class="image-choices-entry-value" onchange="imageChoices_updateEntrySetting(this.value);">','<option value="form_setting"'+t+">"+imageChoicesFieldStrings.entrySettingForm+c+"</option>",'<option value="value"'+a+">"+imageChoicesFieldStrings.entrySettingValue+"</option>",'<option value="image"'+g+">"+imageChoicesFieldStrings.entrySettingImage+"</option>",'<option value="text"'+l+">"+imageChoicesFieldStrings.entrySettingText+"</option>",'<option value="image_text"'+n+">"+imageChoicesFieldStrings.entrySettingImageText+"</option>",'<option value="image_value"'+h+">"+imageChoicesFieldStrings.entrySettingImageValue+"</option>","</select>","</li>"].join("")},showLabelsToggle:function(e,i){var o=e===!0?' checked="checked"':"";return['<li class="image-choices-setting-title field_setting">','<label class="section_label">'+imageChoicesFieldStrings.displaySettingsTitle+"</label>","</li>",'<li class="image-choices-setting-show-labels field_setting">','<label><input id="image_choices_show_labels_'+i+'" class="image_choices_show_labels" type="checkbox" '+o+' onclick="imageChoices_toggleShowLabels(this.checked);" onkeypress="imageChoices_toggleShowLabels(this.checked);"> '+imageChoicesFieldStrings.showLabels+"</label>","<p><small>"+imageChoicesFieldStrings.showLabelsDescription+"</small></p>","</li>"].join("")},showPricesToggle:function(e,i){var o=e===!0?' checked="checked"':"";return['<li class="image-choices-setting-title field_setting image-choices-setting-title-show-prices">','<label class="section_label">'+imageChoicesFieldStrings.priceSettingsTitle+"</label>","</li>",'<li class="image-choices-setting-show-prices field_setting">','<label><input id="image_choices_show_prices_'+i+'" class="image_choices_show_prices" type="checkbox" '+o+' onclick="imageChoices_toggleShowPrices(this.checked);" onkeypress="imageChoices_toggleShowPrices(this.checked);"> '+imageChoicesFieldStrings.showPrices+"</label>","<p><small>"+imageChoicesFieldStrings.showPricesDescription+"</small></p>","</li>"].join("")},useLightboxToggle:function(e,i){var o=e===!0?' checked="checked"':"";return['<li class="image-choices-setting-title field_setting">','<label class="section_label">'+imageChoicesFieldStrings.lightboxSettingsTitle+"</label>","</li>",'<li class="image-choices-setting-use-lightbox field_setting">','<label><input id="image_choices_use_lightbox_'+i+'" class="image_choices_use_lightbox" type="checkbox" '+o+' onclick="imageChoices_toggleUseLightbox(this.checked);" onkeypress="imageChoices_toggleUseLightbox(this.checked);"> '+imageChoicesFieldStrings.useLightbox+"</label>","<p><small>"+imageChoicesFieldStrings.useLightboxDescription+"</small></p>","</li>"].join("")},choicesLayoutSelect:function(e,i){var o=void 0!==e?e:"horizontal",s="horizontal"===o?' selected="selected"':"",c="vertical"===o?' selected="selected"':"";return['<li class="image-choices-setting-layout field_setting">','<label class="gfield_value_label" for="image-choices-layout-'+i+'">'+imageChoicesFieldStrings.selectLayout+"</label>",'<select id="image-choices-layout-'+i+'" class="image-choices-layout" onchange="imageChoices_updateLayoutSetting(this.value);">','<option value="horizontal"'+s+">"+imageChoicesFieldStrings.layoutHorizontal+"</option>",'<option value="vertical"'+c+">"+imageChoicesFieldStrings.layoutVertical+"</option>","</select>","</li>"].join("")},choicesPreviewRow:function(e,i,o){var s=void 0!==i?i:"",c=void 0!==o?o:"";return['<span class="image-choices-choice-image-wrap" style="background-image:url('+c+')">','<img src="'+c+'" alt="" class="image-choices-choice-image" />',"</span>",'<span class="image-choices-choice-text">'+s+"</span>"].join("")}}}(),imageChoices_GF_UpdateFieldChoices;jQuery(document).bind("gform_load_field_settings",function(e,i,o){if(jQuery(window).on("gf_update_field_choices",function(){setTimeout(function(){imageChoices_getChoices()},10)}),"function"!=typeof imageChoices_GF_UpdateFieldChoices&&(imageChoices_GF_UpdateFieldChoices=UpdateFieldChoices,window.UpdateFieldChoices=function(){imageChoices_GF_UpdateFieldChoices.apply(this,arguments),jQuery(window).trigger("gf_update_field_choices")}),"radio"===i.type||"checkbox"===i.type||"quiz"===i.type&&"radio"==i.inputType||"quiz"===i.type&&"checkbox"==i.inputType||"poll"===i.type&&"radio"==i.inputType||"poll"===i.type&&"checkbox"==i.inputType||"post_custom_field"===i.type&&"radio"==i.inputType||"post_custom_field"===i.type&&"checkbox"==i.inputType||"survey"===i.type&&"radio"==i.inputType||"survey"===i.type&&"checkbox"==i.inputType||"product"===i.type&&"radio"==i.inputType||"option"===i.type&&"radio"==i.inputType||"option"===i.type&&"checkbox"==i.inputType)!function(e){setTimeout(function(){var i=jQuery("#field_"+e.id+" #field_settings");jQuery("#field_"+e.id).addClass("image-choices-admin-field");var o=e.imageChoices_enableImages===!0;i.find("input.field_choice_images_enabled").length||i.find('[id*="gfield_settings_choices_container"]').prepend(imageChoices_markup.enableImagesToggle(o,e.id)),imageChoices_toggleEnableImages(o);var s=void 0!==e.imageChoices_useLightbox&&e.imageChoices_useLightbox;i.find("input.image_choices_use_lightbox").length||i.find(".css_class_setting").after(imageChoices_markup.useLightboxToggle(s,e.id)),imageChoices_toggleUseLightbox(s);var c=void 0===e.imageChoices_showLabels||e.imageChoices_showLabels;if(i.find("input.image_choices_show_labels").length||i.find(".css_class_setting").after(imageChoices_markup.showLabelsToggle(c,e.id)),imageChoices_toggleShowLabels(c),"product"===e.type){var t=void 0!==e.imageChoices_showPrices&&e.imageChoices_showPrices;i.find("input.image_choices_show_prices").length||i.find(".image-choices-setting-show-labels").after(imageChoices_markup.showPricesToggle(t,e.id)),imageChoices_toggleShowPrices(t)}else i.find("input.image_choices_show_prices").length&&(i.find(".image-choices-setting-title-show-prices").remove(),i.find(".image-choices-setting-show-prices").remove());var a=void 0!==e.imageChoices_entrySetting?e.imageChoices_entrySetting:"form_setting";if(i.find(".image-choices-entry-value").length){var g=i.find(".image-choices-entry-value");g.val(a),g.find("option[selected]").length&&g.find("option[selected]").removeAttr("selected"),g.find('option[value="'+a+'"]').prop("selected",!0)}else i.find(".image-choices-setting-show-labels").after(imageChoices_markup.entryValueSelect(a,e.id));imageChoices_updateEntrySetting(a),i.find('[class*="-choice-row"]').each(function(i){var o=jQuery(this),s=o.data("index"),c=e.choices.length&&void 0!==e.choices[s].imageChoices_image?e.choices[s].imageChoices_image:"",t=e.choices.length&&void 0!==e.choices[s].imageChoices_imageID?e.choices[s].imageChoices_imageID:"";o.find(".image-choices-option-image").length||o.find(".field-choice-text").before(imageChoices_markup.choicesAdminRow(s,c,t));var a=o.find(".image-choices-option-image");""!==a.val()&&o.addClass("image-choices-has-image")}),imageChoices_updateFieldPreview(e)},10)}(i);else{var s=jQuery("#field_"+field.id+" #field_settings");s.find(".image-choices-toggle-wrap").length&&(s.find(".image-choices-toggle-wrap").remove(),imageChoices_toggleEnableImages(!1)),s.find(".image-choices-setting-show-labels").length&&(s.find(".image-choices-setting-show-labels").remove(),imageChoices_toggleShowLabels(!1))}}),jQuery(document).ready(function(){jQuery(".gfield.image-choices-admin-field").each(function(){var e=jQuery(this);e.find(".ginput_container .gfield_radio > li, .ginput_container .gfield_checkbox > li").each(function(e){var i=jQuery(this);i.addClass("image-choices-choice")})});var e,i=jQuery("#gf_image_choices_custom_css_global");i.length&&(i.after('<div id="gf_image_choices_custom_css_global_editor">'+i.text()+"</div>"),e=ace.edit("gf_image_choices_custom_css_global_editor"),e.setOptions({showInvisibles:!1,showGutter:!0,showLineNumbers:!0,displayIndentGuides:!1,scrollPastEnd:!1,theme:"ace/theme/xcode"}),e.session.setMode("ace/mode/css"),e.getSession().on("change",function(){i.val(e.getSession().getValue())}));var o=jQuery("#gf_image_choices_custom_css");o.length&&(o.after('<div id="gf_image_choices_custom_css_editor">'+o.text()+"</div>"),e=ace.edit("gf_image_choices_custom_css_editor"),e.setOptions({showInvisibles:!1,showGutter:!0,showLineNumbers:!0,showFoldWidgets:!1,displayIndentGuides:!1,scrollPastEnd:!1,theme:"ace/theme/xcode"}),e.session.setMode("ace/mode/css"),e.getSession().on("change",function(){o.val(e.getSession().getValue())}))});